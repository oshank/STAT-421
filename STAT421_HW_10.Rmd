---
title: "STAT 421 HW 10"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Part a)

```{r}
rateParam = 1/5

time <- 0
arrivalTimes <- NULL  #not the most efficient way to do this in terms of memory
while(time < 100)
{
	waitTime <- rexp(1, rate = rateParam)
	time <- time + waitTime
	arrivalTimes <- c(arrivalTimes, time)
}

plot(arrivalTimes, seq(1, length(arrivalTimes)), type = 's')


```

## Part b)

The distribution of the number of arrivals should be a Poisson(20).

## Part c)

```{r}
rateParam = 1/5

trials <- list()

for(i in 1:100){
  
  arrivalTimes <- NULL  #not the most efficient way to do this in terms of memory
  time <- 0
  
  while(time < 100)
  {
	  waitTime <- rexp(1, rate = rateParam)
	  time <- time + waitTime
	  arrivalTimes <- c(arrivalTimes, time)
  }
  arrivalTimes
  trials[[i]] <- arrivalTimes
}
#plot(arrivalTimes, seq(1, length(arrivalTimes)), type = 's')

```


## Part c)a)

```{r}

trialsVector <- numeric()

for(i in 1:100){
  trialsVector <- c(trialsVector, trials[[i]])
}



hist(trialsVector, freq = F,col="grey")
xlines <-seq(0,100,length.out=100) #seq of x for pdf
lines(x = xlines,y=dpois(round(xlines),rateParam*100))

```


## Part d)

```{r}

num0to50 <- sum(trialsVector<=50)
num50to100 <- sum(trialsVector<=100) - num0to50

```


## Part e)

```{r}

rateParam = 1/5

timetrials <- numeric()

for(i in 1:100){
  
  arrivalTimes <- NULL  #not the most efficient way to do this in terms of memory
  time <- 0
  j<-1
  
  while(j < 20)
  {
	  waitTime <- rexp(1, rate = rateParam)
	  time <- time + waitTime
	  arrivalTimes <- c(arrivalTimes, time)
	  j <- j+1
  }
  timetrials[i] <- time
}


hist(timetrials, freq = F)

```







